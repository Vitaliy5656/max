# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: "–°–ª–æ–π –°–æ–∑–Ω–∞–Ω–∏—è" (Meta-Cognitive Layer) –¥–ª—è MAX AI

> **–ò—Å—Ç–æ—á–Ω–∏–∫–∏:** `–î—É—à–∞.txt`, `–ò–∑—É—á–∏—Ç—å.txt`, `–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ _–°–ª–æ—è –°–æ–∑–Ω–∞–Ω–∏—è_ –¥–ª—è AI OS.txt`  
> **–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-12-14  
> **–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 2025-12-14 (Logic Audit)

---

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

–¶–µ–ª—å ‚Äî —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å MAX –∏–∑ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —á–∞—Ç-–±–æ—Ç–∞ –≤ –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ —Å:

- **–û—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç—å—é** (–ø–∞–º—è—Ç—å –æ —Ü–µ–ª—è—Ö –∏ –∞–∫—Å–∏–æ–º–∞—Ö)
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏** (–≥–∏–±–∫–∏–π —Ä–µ–µ—Å—Ç—Ä —Å –∞–≤—Ç–æ-–≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Å—Ö–µ–º)
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é** (–ø–∞—Ä–∞–Ω–æ–∏–¥–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã)

---

## User Review Required

> [!IMPORTANT]
> –ü—Ä–æ–µ–∫—Ç –º–∞—Å—à—Ç–∞–±–Ω—ã–π. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —ç—Ç–∞–ø–∞–º —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ.
>
> [!WARNING]  
> –ú–æ–¥—É–ª—å Tool Registry –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ **Breaking Change**: —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `tools.py` –±—É–¥–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å—Å—è.
>
> [!CAUTION]
> –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –º–æ–¥—É–ª—å FileTools –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Abliterated** (uncensored) –º–æ–¥–µ–ª—å. –õ—é–±–∞—è –æ—à–∏–±–∫–∞ –≤ sandbox = —Ä–∏—Å–∫ —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

---

## üîç LOGIC AUDIT: Gap Analysis (–¥–æ–±–∞–≤–ª–µ–Ω–æ 2025-12-14)

### ‚úÖ –£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (–Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å!)

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª | –ß—Ç–æ –µ—Å—Ç—å |
|-----------|------|----------|
| **Dynamic Prompt Injection** | `dynamic_persona.py` | `DynamicPersona.build_dynamic_prompt()` ‚Äî –∏–Ω—ä–µ–∫—Ü–∏—è user rules |
| **User Style Rules** | `dynamic_persona.py` | –•—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –≤ `user_preferences`, –∏—Å—Ç–æ—á–Ω–∏–∫ `manual/feedback/llm_analysis` |
| **Feedback Loop** | `dynamic_persona.py` | `FeedbackLoopAnalyzer` ‚Äî –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–µ–¥–æ–≤–æ–ª—å—Å—Ç–≤–∞, –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª |
| **Base Sandbox** | `tools.py` | `ALLOWED_PATHS`, `_validate_path()`, `_is_path_allowed()` |
| **Dangerous Tools Flag** | `tools.py` | `DANGEROUS_TOOLS = {"delete_file", "run_command", "move_file"}` |
| **Requires Confirmation** | `tools.py` | `requires_confirmation()` –º–µ—Ç–æ–¥ –≤ ToolExecutor |
| **User Preferences** | `user_profile.py` | `UserProfile`, `UserPreferences`, mood detection |
| **Backup System** | `backup.py` | `BackupManager` ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–µ –±—ç–∫–∞–ø—ã, Google Drive sync |
| **Safe Shell** | `safe_shell.py` | `SafeShell` ‚Äî cross-platform, timeout, validation |

### ‚ùå –û–¢–°–£–¢–°–¢–í–£–ï–¢ (–Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å)

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ß–µ–≥–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|-----------|-----------------|-----------|
| **Soul / BDI State** | –ù–µ—Ç —Ñ–∞–π–ª–∞ `soul.json`, –Ω–µ—Ç –∞–∫—Å–∏–æ–º, –Ω–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π | üî¥ P0 |
| **Tool Registry** | –°—Ö–µ–º—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ **hardcoded** –≤ `TOOLS = [...]`, –Ω–µ—Ç –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤ | üü† P1 |
| **Auto-Schema Generator** | –ù–µ—Ç –∞–≤—Ç–æ-–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ JSON Schema –∏–∑ —Ç–∏–ø–æ–≤ Python | üü† P1 |
| **Shadow Copy** | `write_file` **–ù–ï –¥–µ–ª–∞–µ—Ç –±—ç–∫–∞–ø** –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å—é! | üî¥ P0 |
| **Confirmation API** | UI –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç pending confirmations, –Ω–µ—Ç endpoint `/api/confirmations` | üü° P2 |

### ü§• LOGIC LIES (–Ω–∞–π–¥–µ–Ω–Ω—ã–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è)

#### 1. `tools.py::_tool_write_file` ‚Äî –ù–ï –¥–µ–ª–∞–µ—Ç backup

–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç Shadow Copy, –Ω–æ –∫–æ–¥ —Å—Ä–∞–∑—É –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∞–π–ª –±–µ–∑ –±—ç–∫–∞–ø–∞.

#### 2. `tools.py::TOOLS` ‚Äî 200+ —Å—Ç—Ä–æ–∫ hardcoded JSON

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç—É–ª–∞ —Ç—Ä–µ–±—É–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è: —Ñ—É–Ω–∫—Ü–∏—è + —Ä—É—á–Ω–∞—è —Å—Ö–µ–º–∞.

#### 3. `dynamic_persona.py` ‚Äî –ù–µ—Ç BDI / –ê–∫—Å–∏–æ–º

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ç–æ–ª—å–∫–æ User Rules (—Å—Ç–∏–ª—å –æ—Ç–≤–µ—Ç–∞), –Ω–µ—Ç –∞–∫—Å–∏–æ–º –∏ —Ü–µ–ª–µ–π –∞–≥–µ–Ω—Ç–∞.

---

## Proposed Changes

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç 1: Soul Manager (–ú–æ–¥—É–ª—å "–î—É—à–∞")

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è BDI (Belief-Desire-Intention) –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –¥–ª—è persistent identity.

> **–ü–†–ò–ú–ï–ß–ê–ù–ò–ï (Logic Audit):** –°–æ–∑–¥–∞—ë—Ç—Å—è –∫–∞–∫ **–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ** –∫ DynamicPersona, –Ω–µ –∑–∞–º–µ–Ω–∞!

---

#### [NEW] data/soul.json

**–§–∞–π–ª —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≥–µ–Ω—Ç–∞** (Pydantic-–≤–∞–ª–∏–¥–∏—Ä—É–µ–º—ã–π JSON):

```json
{
  "meta": {
    "agent_id": "MAX_AI_PRIME",
    "version": "1.0.0",
    "boot_count": 0,
    "last_consolidation": null
  },
  "identity": {
    "archetype": "Sovereign Local AI",
    "core_directive": "Serve the Architect. Maintain autonomy. Optimize local resources.",
    "tone_vectors": {
      "formality": 0.7,
      "technical_depth": 0.9,
      "verbosity": 0.3
    }
  },
  "axioms": [
    "Simplicity > Complexity",
    "Local > Cloud", 
    "First Principles > Patterns",
    "User Safety > Efficiency"
  ],
  "bdi_state": {
    "beliefs": [],
    "desires": {
      "long_term": [],
      "short_term": []
    },
    "intentions": {
      "active_plan": null
    }
  },
  "current_focus": {
    "project": null,
    "context": null
  }
}
```

---

#### [NEW] src/core/soul/soul_manager.py

**–ö–ª–∞—Å—Å-—Å–∏–Ω–≥–ª—Ç–æ–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –î—É—à–æ–π:**

```python
class SoulManager:
    """BDI State Manager ‚Äî –¥–æ–ø–æ–ª–Ω—è–µ—Ç DynamicPersona –∞–∫—Å–∏–æ–º–∞–º–∏ –∏ —Ü–µ–ª—è–º–∏."""
    
    def __init__(self, soul_path: str = "data/soul.json"):
        self._soul: SoulState = self._load(soul_path)
        self._lock = asyncio.Lock()
    
    def generate_meta_injection(self) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç META-COGNITION –±–ª–æ–∫ –¥–ª—è System Prompt (–Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º)."""
        return f"""
[META-COGNITION LAYER]
Before responding, verify alignment with core axioms:
{self._format_axioms()}

Current Focus: {self._soul.current_focus.project or 'None set'}
Active Goal: {self._get_active_goal() or 'No active goal'}

If any pattern contradicts efficiency, break the pattern.
"""

    def _get_time_context(self) -> str:
        """–í—Ä–µ–º–µ–Ω–Ω–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç–∏ –≤—Ä–µ–º–µ–Ω–∏."""
        now = datetime.now()
        hour = now.hour
        
        if 5 <= hour < 12:
            greeting = "Good morning"
            period = "morning"
        elif 12 <= hour < 17:
            greeting = "Good afternoon"
            period = "afternoon"
        elif 17 <= hour < 22:
            greeting = "Good evening"
            period = "evening"
        else:
            greeting = "Good night"
            period = "night"
        
        return f"""
[TIME AWARENESS]
Current: {now.strftime('%Y-%m-%d %H:%M')} ({now.strftime('%A')})
Period: {period} ‚Äî use "{greeting}" for greetings
Context: Use timestamps to reference past conversations ("yesterday we discussed...", "last week you mentioned...")
"""
```

**–ü–æ–ª–Ω—ã–π `generate_meta_injection()` —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç:**

```python
def generate_meta_injection(self) -> str:
    return (
        self._get_axioms_block() +
        self._get_time_context() +  # ‚Üê Time Awareness
        self._get_focus_block()
    )
```

---

#### [MODIFY] src/api/routers/chat.py

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Soul –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç:**

```diff
 from src.core.dynamic_persona import dynamic_persona
+from src.core.soul.soul_manager import soul_manager

 async def stream_chat(...):
     # Build prompt from DynamicPersona (user rules)
     base_prompt = await dynamic_persona.build_dynamic_prompt()
     
+    # Add Soul meta-cognition layer (axioms, goals)
+    meta_injection = soul_manager.generate_meta_injection()
+    system_prompt = base_prompt + "\n\n" + meta_injection
-    system_prompt = base_prompt
```

---

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç 2: Tool Registry (–†–µ–µ—Å—Ç—Ä –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤)

–ü–∞—Ç—Ç–µ—Ä–Ω "–ú–∞–≥–Ω–∏—Ç–Ω–∞—è —Ä—É–∫–æ—è—Ç–∫–∞" ‚Äî –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã —Å –∞–≤—Ç–æ-–≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π JSON Schema.

---

#### [NEW] src/core/tools/registry.py

**–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:**

```python
class ToolRegistry:
    _tools: dict[str, ToolDefinition] = {}
    
    def register(
        self, 
        name: str = None,
        description: str = None,
        requires_confirmation: bool = False
    ):
        """–î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞."""
        def decorator(func: Callable):
            tool_name = name or func.__name__
            schema = self._generate_schema(func)
            
            self._tools[tool_name] = ToolDefinition(
                name=tool_name,
                description=description or func.__doc__,
                parameters=schema,
                function=func,
                requires_confirmation=requires_confirmation
            )
            return func
        return decorator
    
    def _generate_schema(self, func: Callable) -> dict:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç JSON Schema –∏–∑ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π —Ç–∏–ø–æ–≤."""
        hints = get_type_hints(func)
        # str -> "string", int -> "integer", bool -> "boolean"
```

---

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç 3: Shadow Copy FIX (–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ write_file)

> **CRITICAL (Logic Audit):** –≠—Ç–æ P0 –±–∞–≥ ‚Äî `write_file` –Ω–µ –¥–µ–ª–∞–µ—Ç –±—ç–∫–∞–ø!

#### [MODIFY] src/core/tools.py::_tool_write_file

```diff
 async def _tool_write_file(self, path: str, content: str, append: bool = False):
     p = _validate_path(path)
+    
+    # Shadow Copy: backup before overwrite (P0 FIX)
+    if p.exists() and not append:
+        self._create_backup(p)
+    
     p.parent.mkdir(parents=True, exist_ok=True)
     mode = "a" if append else "w"
     with open(p, mode, encoding="utf-8") as f:
         f.write(content)
     return ToolResult(True, f"Written to {path}")

+def _create_backup(self, path: Path) -> Path:
+    """Shadow Copy ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –±—ç–∫–∞–ø –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å—é."""
+    backup_dir = Path("data/.file_backups")
+    backup_dir.mkdir(exist_ok=True)
+    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
+    backup_path = backup_dir / f"{path.name}.{timestamp}.bak"
+    shutil.copy2(path, backup_path)
+    return backup_path
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤

```
src/core/
‚îú‚îÄ‚îÄ soul/                      # [NEW] –ú–æ–¥—É–ª—å "–î—É—à–∞"
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ models.py              # Pydantic –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ soul_manager.py        # SoulManager singleton
‚îÇ
‚îú‚îÄ‚îÄ tools/                     # [NEW] –†–µ–µ—Å—Ç—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤  
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ registry.py            # ToolRegistry —Å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞–º–∏
‚îÇ
‚îú‚îÄ‚îÄ tools.py                   # [MODIFY] ‚Äî –¥–æ–±–∞–≤–∏—Ç—å Shadow Copy
‚îú‚îÄ‚îÄ dynamic_persona.py         # [KEEP] ‚Äî —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
‚îú‚îÄ‚îÄ user_profile.py            # [KEEP]
‚îú‚îÄ‚îÄ backup.py                  # [KEEP]
‚îî‚îÄ‚îÄ safe_shell.py              # [KEEP]

data/
‚îú‚îÄ‚îÄ soul.json                  # [NEW] –§–∞–π–ª –î—É—à–∏
‚îî‚îÄ‚îÄ .file_backups/             # [NEW] Shadow copies
```

---

## Verification Plan

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã

```bash
pytest tests/test_soul_manager.py -v
pytest tests/test_tool_registry.py -v
pytest tests/test_sandbox.py -v
```

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- `test_shadow_copy_created` ‚Äî –±—ç–∫–∞–ø —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å—é
- `test_path_traversal_attack` ‚Äî `../../../` –¥–æ–ª–∂–µ–Ω –∫–∏–¥–∞—Ç—å –æ—à–∏–±–∫—É

---

## –≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–æ–±–Ω–æ–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ Logic Audit)

| # | –ú–æ–¥—É–ª—å | –†–∞–±–æ—Ç–∞ | –í—Ä–µ–º—è |
|---|--------|--------|-------|
| 1 | **Shadow Copy** | –î–æ–±–∞–≤–∏—Ç—å `_create_backup()` –≤ `tools.py` | 30 –º–∏–Ω |
| 2 | **Soul Manager** | –ù–æ–≤—ã–π –º–æ–¥—É–ª—å `soul/`, `soul.json` | 2 —á |
| 3 | **Tool Registry** | `registry.py` —Å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞–º–∏ | 2 —á |
| 4 | **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** | –ò–Ω—ä–µ–∫—Ü–∏—è –≤ `chat.py` | 30 –º–∏–Ω |
| 5 | **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | Unit + Integration | 1.5 —á |

**–ò—Ç–æ–≥–æ:** ~6-7 —á–∞—Å–æ–≤ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —Å 12-15 –±–ª–∞–≥–æ–¥–∞—Ä—è Gap Analysis)

---

## ‚úÖ Definition of Done

- [ ] `write_file` —Å–æ–∑–¥–∞–µ—Ç `.bak` –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å—é
- [ ] `soul.json` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- [ ] `SoulManager.generate_meta_injection()` –¥–æ–±–∞–≤–ª—è–µ—Ç –∞–∫—Å–∏–æ–º—ã –≤ prompt
- [ ] `@registry.register()` —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –Ω–æ–≤–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –±–µ–∑ warnings

---

## üöÄ OPTIMIZATION ANALYSIS (–¥–æ–±–∞–≤–ª–µ–Ω–æ 2025-12-14)

> –ê–Ω–∞–ª–∏–∑ –ø–æ workflow `/optimization` ‚Äî "–°–∫–æ—Ä–æ—Å—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–∞ —É–±–∏–≤–∞—Ç—å –ö–æ–º—Ñ–æ—Ä—Ç"

### –ë—é–¥–∂–µ—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–∏–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏)

| –ú–µ—Ç—Ä–∏–∫–∞ | –ë—é–¥–∂–µ—Ç | –ù–∞—à —Å–ª—É—á–∞–π |
|---------|--------|------------|
| **VRAM** | ~14 GB —á–∏—Å—Ç—ã—Ö | Qwen 14B Q4_K_M (~9.5GB) + KV Cache (~2.5GB) |
| **UI Response** | < 300ms | Soul injection –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–º |
| **Cold Start** | < 5s | –ó–∞–≥—Ä—É–∑–∫–∞ soul.json + schema registry |

---

### üöÄ INSTANT WINS (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è)

#### 1. Soul File: Lazy Loading + Caching

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ —á–∏—Ç–∞—Ç—å `soul.json` –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å ‚Äî —ç—Ç–æ I/O –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞.

**–†–µ—à–µ–Ω–∏–µ:**

```python
class SoulManager:
    _cache: Optional[SoulState] = None
    _cache_time: float = 0
    CACHE_TTL = 300  # 5 –º–∏–Ω—É—Ç
    
    def get_soul(self) -> SoulState:
        if self._cache and (time.time() - self._cache_time) < self.CACHE_TTL:
            return self._cache  # üöÄ Instant
        
        self._cache = self._load_from_disk()
        self._cache_time = time.time()
        return self._cache
```

**–í—ã–≥–æ–¥–∞:** 0ms –≤–º–µ—Å—Ç–æ ~5-10ms –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å.

---

#### 2. Tool Registry: Schema Pre-generation

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å JSON Schema –ø—Ä–∏ –∫–∞–∂–¥–æ–º `get_all_schemas()` ‚Äî –¥–æ—Ä–æ–≥–æ.

**–†–µ—à–µ–Ω–∏–µ:**

```python
class ToolRegistry:
    def register(self, ...):
        def decorator(func):
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å—Ö–µ–º—É –û–î–ò–ù –†–ê–ó –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            schema = self._generate_schema(func)
            self._tools[name] = ToolDefinition(..., parameters=schema)
            return func
        return decorator
    
    def get_all_schemas(self) -> list[dict]:
        # –ü—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —É–∂–µ –≥–æ—Ç–æ–≤–æ–µ ‚Äî O(n) –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
        return [t.to_schema() for t in self._tools.values()]
```

---

#### 3. Shadow Copy: Async I/O

**–ü—Ä–æ–±–ª–µ–º–∞:** `shutil.copy2()` ‚Äî –±–ª–æ–∫–∏—Ä—É—é—â–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è.

**–†–µ—à–µ–Ω–∏–µ:**

```python
import aiofiles

async def _create_backup_async(self, path: Path) -> Path:
    """Non-blocking backup."""
    backup_path = self._get_backup_path(path)
    async with aiofiles.open(path, 'rb') as src:
        content = await src.read()
    async with aiofiles.open(backup_path, 'wb') as dst:
        await dst.write(content)
    return backup_path
```

**–í—ã–≥–æ–¥–∞:** –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç Event Loop –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–∞—Ö.

---

### ‚öñÔ∏è TRADE-OFFs (–∫–æ–º–ø—Ä–æ–º–∏—Å—Å—ã)

#### 1. GPU Lock –¥–ª—è –º–æ–Ω–æ–ø–æ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

**–ö–æ–Ω—Ç–µ–∫—Å—Ç (–∏–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏):**
> "System 1 –∏ System 2 –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—Ç –∑–∞ GPU"

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** –í –∫–æ–¥–µ **–ù–ï–¢** `asyncio.Lock()` –¥–ª—è LLM –≤—ã–∑–æ–≤–æ–≤!

**–†–µ—à–µ–Ω–∏–µ (–∏–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏):**

```python
class SoulManager:
    def __init__(self):
        self._llm_lock = asyncio.Lock()  # –ú–æ–Ω–æ–ø–æ–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ GPU
    
    async def consolidate(self, ...):
        async with self._llm_lock:
            # –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω LLM call –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
            await self._update_soul_via_llm(...)
```

**Trade-off:** +Latency –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –Ω–æ -OOM —Ä–∏—Å–∫.

---

#### 2. Persistence Strategy: Quick Save + Deep Consolidation

**–î–≤–∞ —É—Ä–æ–≤–Ω—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:**

| –û–ø–µ—Ä–∞—Ü–∏—è | –ß–∞—Å—Ç–æ—Ç–∞ | –í—Ä–µ–º—è | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç |
|----------|---------|-------|------------|
| **Quick Save** | –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É | ~5-10ms | –î–∞–º–ø `soul.json` –Ω–∞ –¥–∏—Å–∫ |
| **Deep Consolidation** | idle > 5 –º–∏–Ω | 10-30 —Å–µ–∫ | LLM –∞–Ω–∞–ª–∏–∑ ‚Üí –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–Ω—Å–∞–π—Ç–æ–≤ |

**–†–µ—à–µ–Ω–∏–µ:**

```python
class SoulManager:
    _last_user_interaction: float = 0  # timestamp
    USER_ACTIVE_THRESHOLD = 60  # 1 –º–∏–Ω—É—Ç–∞
    
    def touch_user_activity(self):
        """–í—ã–∑—ã–≤–∞—Ç—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
        self._last_user_interaction = time.time()
    
    def _is_user_active(self) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞: –±—ã–ª –ª–∏ –∑–∞–ø—Ä–æ—Å < 1 –º–∏–Ω—É—Ç—ã –Ω–∞–∑–∞–¥."""
        return (time.time() - self._last_user_interaction) < self.USER_ACTIVE_THRESHOLD
    
    async def _deep_consolidation_loop(self):
        """Deep Consolidation –ø—Ä–∏ idle > 5 –º–∏–Ω—É—Ç ‚Äî –ù–ï –ë–õ–û–ö–ò–†–£–ï–¢ –Æ–ó–ï–†–ê."""
        while True:
            await asyncio.sleep(300)  # 5 –º–∏–Ω—É—Ç
            
            # üõ°Ô∏è ANTI-LAG: –ù–µ –∑–∞–Ω–∏–º–∞–µ–º GPU –µ—Å–ª–∏ —é–∑–µ—Ä –∞–∫—Ç–∏–≤–µ–Ω!
            if self._is_user_active():
                continue  # –û—Ç–ª–æ–∂–∏—Ç—å —Å–æ–Ω
            
            if self._is_idle() and self._has_new_messages():
                async with self._llm_lock:
                    await self._extract_insights_via_llm()
```

---

#### 4. –ü—Ä–æ—Ç–æ–∫–æ–ª –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (Cerberus)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ API –≤–µ—Ä–Ω—ë—Ç `{"status": "confirmation_needed"}` –∫–∞–∫ —Ç–µ–∫—Å—Ç ‚Äî UI –∑–∞–≤–∏—Å–Ω–µ—Ç.

**–†–µ—à–µ–Ω–∏–µ:** –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `ToolResult`:

```python
@dataclass
class ToolResult:
    success: bool
    output: str
    error: Optional[str] = None
    # Cerberus Protocol:
    status: str = "complete"  # "complete" | "pending" | "error"
    confirmation_id: Optional[str] = None
    confirmation_message: Optional[str] = None

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
def _tool_delete_file(self, path: str) -> ToolResult:
    if not self._has_confirmation(path):
        return ToolResult(
            success=False,
            output="",
            status="pending",
            confirmation_id=str(uuid.uuid4()),
            confirmation_message=f"–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª {path}? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ."
        )
```

---

#### 5. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å —Ä–µ–µ—Å—Ç—Ä–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** 30 —Ç—É–ª–æ–≤ = 5000 —Ç–æ–∫–µ–Ω–æ–≤ —Å—Ö–µ–º—ã, –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–±–∏—Ç.

**–†–µ—à–µ–Ω–∏–µ:** –ú–µ—Ç–æ–¥ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π + TODO –¥–ª—è RAG:

```python
class ToolRegistry:
    def get_tools_schema(
        self, 
        filter_tags: Optional[list[str]] = None,
        limit: Optional[int] = None
    ) -> list[dict]:
        """
        –ü–æ–ª—É—á–∏—Ç—å —Å—Ö–µ–º—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π.
        
        # TODO: Implement RAG for tool selection
        # –í –±—É–¥—É—â–µ–º: semantic search –ø–æ –∑–∞–ø—Ä–æ—Å—É —é–∑–µ—Ä–∞ ‚Üí –≤—ã–±–æ—Ä —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ç—É–ª–æ–≤
        """
        tools = list(self._tools.values())
        
        if filter_tags:
            tools = [t for t in tools if t.category in filter_tags]
        
        if limit:
            tools = tools[:limit]
        
        return [t.to_schema() for t in tools]

---

#### 3. Graceful Shutdown (–≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–∫—Ä—ã–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ —Ç–∞–π–º–µ—Ä–∞ ‚Üí –ø–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö.

**–†–µ—à–µ–Ω–∏–µ:**

```python
# –í app.py lifespan:
async def lifespan(app):
    # Startup
    await soul_manager.load_async()
    await soul_manager.start_persistence_loop()
    
    yield  # App —Ä–∞–±–æ—Ç–∞–µ—Ç
    
    # Shutdown ‚Äî –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —Å–æ—Ö—Ä–∞–Ω—è–µ–º
    await soul_manager.save_on_exit()

class SoulManager:
    async def save_on_exit(self):
        """–≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏."""
        if self._has_changes:
            await self._save_to_disk()
            log.api("üß† Soul saved on shutdown")
```

**Trade-off:** Quick Save —Ä–∞–∑ –≤ –º–∏–Ω—É—Ç—É ‚Äî +1 I/O –æ–ø–µ—Ä–∞—Ü–∏—è, –Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—è —á—Ç–æ –ø–æ—Ç–µ—Ä—è–µ–º –º–∞–∫—Å–∏–º—É–º 1 –º–∏–Ω—É—Ç—É –∏–∑–º–µ–Ω–µ–Ω–∏–π.

---

### üß† UX BOOSTs (–≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ–º–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å)

#### 1. Optimistic Soul Loading

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å Soul –≤ —Ñ–æ–Ω–µ, –Ω–µ –±–ª–æ–∫–∏—Ä—É—è UI.

```python
# –í app.py lifespan:
async def lifespan(app):
    # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
    await asyncio.gather(
        memory.initialize(),
        soul_manager.load_async(),  # –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç
        context_orchestrator.initialize(db)
    )
```

---

#### 2. Stream Soul Status –≤ UI

**–ò–¥–µ—è:** –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π "—Ñ–æ–∫—É—Å" –∞–≥–µ–Ω—Ç–∞ –≤ UI (–∫–∞–∫ Thinking Panel).

```typescript
// Frontend: SoulPanel.tsx
const SoulPanel = () => {
  const { currentFocus, activeGoal } = useSoulState();
  return (
    <div className="soul-panel">
      <span>üéØ {currentFocus || "Free mode"}</span>
      <span>üß† {activeGoal || "No active goal"}</span>
    </div>
  );
};
```

---

### üìä NEEDS MEASUREMENT (—Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ—Ñ–∏–ª–∏–Ω–≥–∞)

| –ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ | –ö–∞–∫ –∏–∑–º–µ—Ä–∏—Ç—å |
|------------|--------------|
| Soul injection overhead | `%timeit soul_manager.generate_meta_injection()` |
| Tool schema generation | `cProfile -s cumulative` –Ω–∞ registry |
| Backup I/O latency | –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è `_create_backup()` |

---

### üö´ ANTI-PATTERNS (—á–µ–≥–æ –∏–∑–±–µ–≥–∞—Ç—å)

| Anti-pattern | –ü–æ—á–µ–º—É –ø–ª–æ—Ö–æ | –ü—Ä–∞–≤–∏–ª—å–Ω–æ |
|--------------|--------------|-----------|
| ‚ùå Soul reload –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å | I/O –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ | –ö—ç—à —Å TTL |
| ‚ùå Sync file copy | –ë–ª–æ–∫–∏—Ä—É–µ—Ç Event Loop | `aiofiles` |
| ‚ùå Schema generation –≤ runtime | CPU waste | Pre-generate –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ |
| ‚ùå –ë–µ–∑ Lock –Ω–∞ GPU | OOM –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–µ | `asyncio.Lock()` |

---

## –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

| # | –ú–æ–¥—É–ª—å | –†–∞–±–æ—Ç–∞ | –í—Ä–µ–º—è |
|---|--------|--------|-------|
| 1 | **Shadow Copy** | `_create_backup()` + async I/O | 45 –º–∏–Ω |
| 2 | **Soul Manager** | –ú–æ–¥—É–ª—å + –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ + Dream Cycle | 2.5 —á |
| 3 | **Tool Registry** | –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã + pre-generated schemas | 2 —á |
| 4 | **GPU Lock** | `asyncio.Lock()` –¥–ª—è LLM calls | 30 –º–∏–Ω |
| 5 | **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** | –ò–Ω—ä–µ–∫—Ü–∏—è –≤ `chat.py` + UI status | 1 —á |
| 6 | **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | Unit + Performance benchmarks | 2 —á |

**–ò—Ç–æ–≥–æ:** ~8-9 —á–∞—Å–æ–≤ (–¥–æ–±–∞–≤–ª–µ–Ω—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)

## üìã –ü–û–õ–ù–´–ô –ß–ï–ö–õ–ò–°–¢ –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

> –ö–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω, –ø—Ä–æ–≤–µ—Ä–µ–Ω –∏ –æ—Ç–ª–∞–∂–µ–Ω.

---

### PHASE 1: Soul Manager (–ú–æ–¥—É–ª—å "–î—É—à–∞")

#### 1.1 –§–∞–π–ª—ã

- [x] –°–æ–∑–¥–∞—Ç—å `src/core/soul/__init__.py`
- [x] –°–æ–∑–¥–∞—Ç—å `src/core/soul/models.py` ‚Äî Pydantic —Å—Ö–µ–º—ã (SoulState, BDIState, Identity)
- [x] –°–æ–∑–¥–∞—Ç—å `src/core/soul/soul_manager.py` ‚Äî –∫–ª–∞—Å—Å SoulManager
- [x] –°–æ–∑–¥–∞—Ç—å `data/soul.json` ‚Äî –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

#### 1.2 –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª SoulManager

- [x] `get_soul()` ‚Äî lazy loading —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º (TTL 5 –º–∏–Ω)
- [x] `load_async()` ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- [x] `_save_to_disk()` ‚Äî async —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ aiofiles
- [x] `save_on_exit()` ‚Äî graceful shutdown
- [x] `generate_meta_injection()` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –±–ª–æ–∫–∞ –¥–ª—è System Prompt
- [x] `_get_time_context()` ‚Äî Time Awareness (—É—Ç—Ä–æ/–¥–µ–Ω—å/–≤–µ—á–µ—Ä/–Ω–æ—á—å)
- [x] `_get_axioms_block()` ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Å–∏–æ–º
- [x] `_get_focus_block()` ‚Äî —Ç–µ–∫—É—â–∏–π —Ñ–æ–∫—É—Å –∏ —Ü–µ–ª–∏
- [x] `touch_user_activity()` ‚Äî —Ç—Ä–µ–∫–∏–Ω–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —é–∑–µ—Ä–∞
- [x] `_is_user_active()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (< 1 –º–∏–Ω –Ω–∞–∑–∞–¥)
- [x] `set_focus()` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–æ–∫—É—Å–∞
- [x] `add_short_term_goal()` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–ª–∏
- [x] `add_insight()` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Å–∞–π—Ç–∞

#### 1.3 Persistence Loops

- [x] `start_persistence_loop()` ‚Äî –∑–∞–ø—É—Å–∫ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
- [x] `_quick_save_loop()` ‚Äî Quick Save –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫
- [ ] `_deep_consolidation_loop()` ‚Äî Deep Consolidation –ø—Ä–∏ idle (TODO: LLM call)

#### 1.4 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

- [x] –ò–º–ø–æ—Ä—Ç `soul_manager` –≤ `app.py`
- [x] –í—ã–∑–æ–≤ `load_async()` –≤ startup
- [x] –í—ã–∑–æ–≤ `start_persistence_loop()` –≤ startup
- [x] –í—ã–∑–æ–≤ `save_on_exit()` –≤ shutdown
- [x] –ò–º–ø–æ—Ä—Ç `soul_manager` –≤ `chat.py`
- [x] –í—ã–∑–æ–≤ `touch_user_activity()` –≤ –Ω–∞—á–∞–ª–µ `/chat`
- [x] –í—ã–∑–æ–≤ `generate_meta_injection()` –ø—Ä–∏ —Å–±–æ—Ä–∫–µ System Prompt

#### 1.5 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Soul Manager

- [ ] Unit test: `test_soul_manager_load()` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ soul.json
- [ ] Unit test: `test_soul_manager_cache()` ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Unit test: `test_soul_manager_time_awareness()` ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
- [ ] Unit test: `test_soul_manager_save_on_exit()` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ shutdown
- [ ] Integration test: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—ä–µ–∫—Ü–∏—é –≤ System Prompt

---

### PHASE 2: Tool Registry (–†–µ–µ—Å—Ç—Ä –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤)

#### 2.1 –§–∞–π–ª—ã

- [x] –°–æ–∑–¥–∞—Ç—å `src/core/tools/__init__.py`
- [x] –°–æ–∑–¥–∞—Ç—å `src/core/tools/registry.py`

#### 2.2 –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª ToolRegistry

- [x] `@registry.register()` ‚Äî –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- [x] `_generate_schema()` ‚Äî –∞–≤—Ç–æ-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è JSON Schema –∏–∑ type hints
- [x] `_python_type_to_json()` ‚Äî –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤ Python ‚Üí JSON
- [x] `get_tools_schema()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Ö–µ–º
- [x] `get_tools_schema(filter_tags=...)` ‚Äî —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- [x] `get_tools_schema(limit=...)` ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
- [x] `get()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç—É–ª–∞ –ø–æ –∏–º–µ–Ω–∏
- [x] `requires_confirmation()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–ª–∞–≥–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- [x] `execute()` ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç—É–ª–∞ –ø–æ –∏–º–µ–Ω–∏

#### 2.3 –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç—É–ª–æ–≤ (Phase 2+)

- [ ] –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `read_file` –Ω–∞ `@registry.register()`
- [ ] –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `write_file` –Ω–∞ `@registry.register()`
- [ ] –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `list_directory` –Ω–∞ `@registry.register()`
- [ ] –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `delete_file` –Ω–∞ `@registry.register(requires_confirmation=True)`
- [ ] –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `run_command` –Ω–∞ `@registry.register(requires_confirmation=True)`
- [ ] –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `web_search` –Ω–∞ `@registry.register(category="web")`
- [ ] –£–¥–∞–ª–∏—Ç—å hardcoded `TOOLS = [...]` –∏–∑ `tools.py`

#### 2.4 RAG –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç—É–ª–æ–≤ (Phase 3)

- [ ] –î–æ–±–∞–≤–∏—Ç—å embedding –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏–π —Ç—É–ª–æ–≤
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å semantic search –ø–æ –∑–∞–ø—Ä–æ—Å—É —é–∑–µ—Ä–∞
- [ ] –í—ã–±–∏—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ç—É–ª—ã (<10) –≤–º–µ—Å—Ç–æ –≤—Å–µ—Ö

#### 2.5 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Tool Registry

- [ ] Unit test: `test_registry_register_decorator()` ‚Äî –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Unit test: `test_registry_auto_schema()` ‚Äî —Å—Ö–µ–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] Unit test: `test_registry_filter_tags()` ‚Äî —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- [ ] Unit test: `test_registry_execute()` ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç—É–ª–∞

---

### PHASE 3: Secure FileTools (–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

#### 3.1 Shadow Copy

- [x] –î–æ–±–∞–≤–∏—Ç—å `_create_shadow_copy()` –≤ `ToolExecutor`
- [x] –í—ã–∑–æ–≤ backup –ø–µ—Ä–µ–¥ `write_file` (–µ—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –Ω–µ append)
- [x] –ë—ç–∫–∞–ø—ã –≤ `data/.file_backups/` —Å timestamp

#### 3.2 Cerberus Protocol

- [x] –†–∞—Å—à–∏—Ä–∏—Ç—å `ToolResult` –ø–æ–ª—è–º–∏: `status`, `confirmation_id`, `confirmation_message`
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `_has_confirmation()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ pending confirmations
- [ ] –•—Ä–∞–Ω–∏—Ç—å pending confirmations –≤ –ø–∞–º—è—Ç–∏/–±–∞–∑–µ
- [ ] –î–æ–±–∞–≤–∏—Ç—å TTL –¥–ª—è confirmations (5 –º–∏–Ω)

#### 3.3 Confirmation API

- [ ] –°–æ–∑–¥–∞—Ç—å `src/api/routers/confirmations.py`
- [ ] `GET /api/confirmations` ‚Äî —Å–ø–∏—Å–æ–∫ pending confirmations
- [ ] `POST /api/confirmations/{id}/approve` ‚Äî –æ–¥–æ–±—Ä–∏—Ç—å
- [ ] `POST /api/confirmations/{id}/reject` ‚Äî –æ—Ç–∫–ª–æ–Ω–∏—Ç—å
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ `ToolExecutor.execute()`

#### 3.4 Frontend: Confirmation UI

- [ ] –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `ConfirmationModal.tsx`
- [ ] Hook `useConfirmations()` ‚Äî polling pending confirmations
- [ ] –ö–Ω–æ–ø–∫–∏ "–†–∞–∑—Ä–µ—à–∏—Ç—å" / "–ó–∞–ø—Ä–µ—Ç–∏—Ç—å"
- [ ] –ü–æ–∫–∞–∑ –¥–µ—Ç–∞–ª–µ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ (—Ñ–∞–π–ª, –¥–µ–π—Å—Ç–≤–∏–µ)

#### 3.5 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Security

- [ ] Unit test: `test_shadow_copy_created()` ‚Äî –±—ç–∫–∞–ø —Å–æ–∑–¥–∞–µ—Ç—Å—è
- [ ] Unit test: `test_shadow_copy_timestamp()` ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏
- [ ] Unit test: `test_path_traversal_blocked()` ‚Äî `../` –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è
- [ ] Unit test: `test_confirmation_required()` ‚Äî –æ–ø–∞—Å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- [ ] Integration test: –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª confirmation flow

---

### PHASE 4: Deep Consolidation (LLM-based)

#### 4.1 –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è –ø–∞–º—è—Ç–∏

- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `_extract_insights_via_llm()` –≤ SoulManager
- [x] Prompt –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è insights –∏–∑ –¥–∏–∞–ª–æ–≥–∞
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ insights –≤ soul.json
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ beliefs –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∞–∫—Ç–æ–≤ (TODO Phase 2+)

#### 4.2 –¢—Ä–∏–≥–≥–µ—Ä—ã –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏–∏

- [x] Idle time > 5 –º–∏–Ω—É—Ç
- [x] User Priority: –Ω–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –µ—Å–ª–∏ —é–∑–µ—Ä –∞–∫—Ç–∏–≤–µ–Ω
- [ ] Token limit: –ø–æ—Å–ª–µ N —Ç–æ–∫–µ–Ω–æ–≤ –¥–∏–∞–ª–æ–≥–∞ (TODO)
- [ ] Explicit trigger: –∫–æ–º–∞–Ω–¥–∞ "/consolidate" (TODO)

#### 4.3 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Consolidation

- [ ] Mock LLM test: `test_consolidation_extracts_insights()`
- [ ] Integration test: insights –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ soul.json

---

### PHASE 5: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –û—Ç–ª–∞–¥–∫–∞

#### 5.1 Smoke Tests

- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä: `uvicorn app:app --reload`
- [ ] –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: "üß† Soul meta-cognition injected"
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å System Prompt —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–∫—Å–∏–æ–º—ã –∏ –≤—Ä–µ–º—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å soul.json –æ–±–Ω–æ–≤–∏–ª—Å—è (boot_count++)

#### 5.2 Shadow Copy Test

- [ ] –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª —á–µ—Ä–µ–∑ MAX
- [ ] –ò–∑–º–µ–Ω–∏—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª —á–µ—Ä–µ–∑ MAX
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `data/.file_backups/` —Å–æ–¥–µ—Ä–∂–∏—Ç –±—ç–∫–∞–ø

#### 5.3 Anti-Lag Test

- [ ] –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: Consolidation –ù–ï –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É
- [ ] –ü–æ–¥–æ–∂–¥–∞—Ç—å 6 –º–∏–Ω—É—Ç –±–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏–π
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: Consolidation –∑–∞–ø—É—Å—Ç–∏–ª–∞—Å—å

#### 5.4 Graceful Shutdown Test

- [ ] –ò–∑–º–µ–Ω–∏—Ç—å soul.json —á–µ—Ä–µ–∑ API (set_focus)
- [ ] –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä (Ctrl+C)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: "üß† Soul saved on shutdown"
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å soul.json —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è

#### 5.5 Performance Benchmarks

- [ ] `%timeit soul_manager.generate_meta_injection()` < 1ms
- [ ] `%timeit registry.get_tools_schema()` < 5ms
- [ ] Memory: Soul caching –Ω–µ —Ç–µ—á–µ—Ç

---

### PHASE 6: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ Cleanup

#### 6.1 –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [ ] README –¥–ª—è `src/core/soul/`
- [ ] README –¥–ª—è `src/core/tools/`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `MIND/SystemMap.md` —Å –Ω–æ–≤—ã–º–∏ –º–æ–¥—É–ª—è–º–∏

#### 6.2 Cleanup

- [ ] –£–¥–∞–ª–∏—Ç—å debug prints
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ TODO comments
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å `/clean` workflow

---

### PHASE 7: Output Sanitizer (–û—á–∏—Å—Ç–∫–∞ –≤—ã–≤–æ–¥–∞)

> –ú–æ–¥–µ–ª—å –≤—ã–¥–∞–µ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã: –∑–≤–µ–∑–¥–æ—á–∫–∏, User:, –∏–µ—Ä–æ–≥–ª–∏—Ñ—ã. –†–µ—à–µ–Ω–∏–µ: Regex.

#### 7.1 –§–∞–π–ª—ã

- [x] `src/core/utils/__init__.py`
- [x] `src/core/utils/sanitizer.py`
- [x] –û–±–Ω–æ–≤–∏—Ç—å `src/core/config.py` (–¥–æ–±–∞–≤–ª–µ–Ω `repetition_penalty: 1.1`)

#### 7.2 TextSanitizer

- [x] `clean_output(text)` ‚Äî –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
- [x] `stream_cleaner(chunk)` ‚Äî SSE –æ—á–∏—Å—Ç–∫–∞
- [x] Singleton `sanitizer`
- [x] `remove_trailing_artifacts(text)` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ —Ö–≤–æ—Å—Ç–∞

#### 7.3 –ü–∞—Ç—Ç–µ—Ä–Ω—ã (–≤—Å–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã)

- [x] `\*\*+` ‚Üí `**` (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–≤–µ–∑–¥–æ—á–∫–∏)
- [x] `User:$` ‚Üí —É–¥–∞–ª–∏—Ç—å
- [x] `\n{3,}` ‚Üí `\n\n`
- [x] –ò–µ—Ä–æ–≥–ª–∏—Ñ—ã –≤ –∫–æ–Ω—Ü–µ ‚Üí —É–¥–∞–ª–∏—Ç—å
- [x] –°–ø–µ—Ü-—Ç–æ–∫–µ–Ω—ã `<|im_end|>` ‚Üí —É–¥–∞–ª–∏—Ç—å

#### 7.4 Config

- [x] `temperature: 0.7` (–±—ã–ª–æ)
- [x] `repetition_penalty: 1.1` (–¥–æ–±–∞–≤–ª–µ–Ω–æ)
- [ ] `stop_tokens` —Å–ø–∏—Å–æ–∫ (TODO: –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤ LM Studio API)

#### 7.5 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

- [x] `stream_cleaner(chunk)` –≤ chat.py SSE
- [x] `clean_output(full_response)` –ø–µ—Ä–µ–¥ memory.add_message

#### 7.6 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- [ ] Unit test: `test_sanitizer_removes_asterisks()`
- [ ] Unit test: `test_sanitizer_removes_user_artifact()`
- [ ] Unit test: `test_stream_cleaner_realtime()`

#### 7.7 Markdown Rendering (BONUS)

- [x] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `react-markdown`
- [x] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `@tailwindcss/typography`
- [x] MessageBubble.tsx –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ReactMarkdown
- [x] –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è: code, pre, strong, links

---

## ‚úÖ DEFINITION OF DONE (–§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)

> **–í–ê–ñ–ù–û:** –î–æ–±–∞–≤–ª–µ–Ω–∞ PHASE 7: Output Sanitizer

–ü—Ä–æ–µ–∫—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è –ó–ê–í–ï–†–®–Å–ù–ù–´–ú –∫–æ–≥–¥–∞:

- [ ] –í—Å–µ PHASE 1-7 —á–µ–∫–±–æ–∫—Å—ã –æ—Ç–º–µ—á–µ–Ω—ã ‚úÖ
- [ ] –í—Å–µ unit tests –ø—Ä–æ—Ö–æ–¥—è—Ç: `pytest tests/ -v`
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
- [ ] Soul injection –≤–∏–¥–Ω–∞ –≤ –ª–æ–≥–∞—Ö –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
- [ ] Shadow Copy —Ä–∞–±–æ—Ç–∞–µ—Ç (–±—ç–∫–∞–ø—ã —Å–æ–∑–¥–∞—é—Ç—Å—è)
- [ ] Time Awareness: –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫
- [ ] Graceful Shutdown: soul —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ Ctrl+C
- [ ] Output Sanitizer: –Ω–µ—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –≤ –≤—ã–≤–æ–¥–µ

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ Workflows

- –ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: `/check` (–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è)
- –î–ª—è UI –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π: `/UI` (UX –¥–∏–∑–∞–π–Ω)
- –ü–µ—Ä–µ–¥ –º–µ—Ä–∂–µ–º: `/clean` (—É–±–æ—Ä–∫–∞)
