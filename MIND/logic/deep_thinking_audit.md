# –ì–ª—É–±–æ–∫–∏–π –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ê—É–¥–∏—Ç: –ì–ª—É–±–æ–∫–æ–µ –ú—ã—à–ª–µ–Ω–∏–µ (Cognitive Architecture)

## 0. –ö–∞—Ä—Ç–∞ –ü—É—Ç–∏ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (User Journey)

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: "–ù–µ–≤–æ–∑–º–æ–∂–Ω—ã–π" –≤–æ–ø—Ä–æ—Å**
*–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–¥–∞–µ—Ç –≤–æ–ø—Ä–æ—Å, —Ç—Ä–µ–±—É—é—â–∏–π –º–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç–æ–≥–æ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ö–∞–∫ —Ç—é–ª—å–ø–∞–Ω–æ–º–∞–Ω–∏—è XVII –≤–µ–∫–∞ –ø–æ–≤–ª–∏—è–ª–∞ –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—ã–Ω–∫–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç?").*

- **–û–∂–∏–¥–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –≤—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∂–∏–º "–î—É–º–∞—é" -> –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ" -> "–ß–µ—Ä–Ω–æ–≤–∏–∫" -> "–ö—Ä–∏—Ç–∏–∫–∞" -> "–£—Ç–æ—á–Ω–µ–Ω–∏–µ" -> –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç.
- **–†–µ–∞–ª—å–Ω–æ—Å—Ç—å**: –û–ë–†–ê–ë–û–¢–ö–ê –í –°–õ–ï–ü–£–Æ. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ "Thinking...", –Ω–æ –Ω–µ –≤–∏–¥–∏—Ç —à–∞–≥–æ–≤ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –ö—Ä–∏—Ç–∏–∫–∏. –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π "–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–æ–Ω–æ–ª–æ–≥" —Å–∫—Ä—ã—Ç –¥–æ —Å–∞–º–æ–≥–æ –∫–æ–Ω—Ü–∞.

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: –¶–∏–∫–ª "–ö—Ä–∏—Ç–∏–∫–∏"**
*–°–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–µ–≤–µ—Ä–Ω—ã–π –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ª–æ–≤–∏—Ç —ç—Ç–æ.*

- **–û–∂–∏–¥–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ "Thinking". –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç "–ö—Ä–∏—Ç–∏–∫–∞: –ù–∞–π–¥–µ–Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞... –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞".
- **–†–µ–∞–ª—å–Ω–æ—Å—Ç—å**: –°–∏—Å—Ç–µ–º–∞ –∑–∞—Ü–∏–∫–ª–∏–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å—Ç–æ –¥–æ–ª—å—à–µ –≤–∏–¥–∏—Ç "Analyzing...". –ï—Å–ª–∏ **–ü–ª–∞–Ω** –±—ã–ª –æ—à–∏–±–æ—á–Ω—ã–º, —Å–∏—Å—Ç–µ–º–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç **–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ**, –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä—É–µ—Ç (–¶–∏–∫–ª: Executor <-> Verifier).

**–°—Ü–µ–Ω–∞—Ä–∏–π 3: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
*–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `langgraph`.*

- **–û–∂–∏–¥–∞–Ω–∏–µ**: –ö—Ä–∞—Å–∏–≤—ã–π –æ—Ç–∫–∞—Ç (fallback) –∏–ª–∏ –ø–æ–Ω—è—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–Ω–∞—è –æ—à–∏–±–∫–∞.
- **–†–µ–∞–ª—å–Ω–æ—Å—Ç—å**: –°–∏—Å—Ç–µ–º–∞ –¥–µ–ª–∞–µ—Ç –≤–∏–¥, —á—Ç–æ "–ø–æ–¥—É–º–∞–ª–∞", –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫—É "Error: LangGraph library not installed..." –∫–∞–∫ –±—É–¥—Ç–æ —ç—Ç–æ –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

## 1. –õ–æ–≥–∏–∫–∞ –∏ –ù–∞–º–µ—Ä–µ–Ω–∏—è (Logic Lies)

- **[ü§• LOGIC LIE] –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Ü–∏–∫–ª–∞ (Loop Shortcut)**: –¶–∏–∫–ª —É—Ç–æ—á–Ω–µ–Ω–∏—è –∏–¥–µ—Ç –ø–æ –ø—É—Ç–∏ `Verifier -> Memory -> Executor`. –û–Ω **–æ–±—Ö–æ–¥–∏—Ç** `Planner`.
  - *–ü—Ä–æ–±–ª–µ–º–∞*: –ï—Å–ª–∏ –∏–∑–Ω–∞—á–∞–ª—å–Ω—ã–π –ü–ª–∞–Ω —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ –ø–ª–æ—Ö, –ê–≥–µ–Ω—Ç –±—É–¥–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å *—Ç–æ—Ç –∂–µ —Å–∞–º—ã–π –ø–ª–∞–Ω* 5 —Ä–∞–∑, –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–æ–≤–∞–ª–∏–≤–∞—è—Å—å. –ù–∞—Å—Ç–æ—è—â–µ–µ "–ì–ª—É–±–æ–∫–æ–µ –ú—ã—à–ª–µ–Ω–∏–µ" –¥–æ–ª–∂–Ω–æ —É–º–µ—Ç—å —Å–∫–∞–∑–∞—Ç—å: "–ú–æ–π –ø–ª–∞–Ω –ø–ª–æ—Ö, –º–Ω–µ –Ω—É–∂–µ–Ω –Ω–æ–≤—ã–π –ø–ª–∞–Ω".
- **[ü§• LOGIC LIE] –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–∫–∞—Ç–∞ (Mock Fallback)**: –ë–ª–æ–∫ `try-except ImportError` –¥–ª—è `langgraph` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∏–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ —Å—Ç—Ä–æ–∫–æ–π –æ—à–∏–±–∫–∏. –≠—Ç–æ –º–∞—Å–∫–∏—Ä—É–µ—Ç –æ—à–∏–±–∫—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º—ã—Å–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.

## 2. "–ú–µ—Ä—Ç–≤—ã–π" –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Lazy Implementation)

- **[üìâ LAZY IMPL] –°–∫—Ä—ã—Ç—ã–π –º—ã—Å–ª–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å**: `api.py` —Å—Ç—Ä–∏–º–∏—Ç —Å–æ–±—ã—Ç–∏—è `thinking: start` –∏ `thinking: end`. –û–Ω **–Ω–µ —Å—Ç—Ä–∏–º–∏—Ç** –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π (`status: planning` -> `status: executing`).
  - *–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ*: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á—É–≤—Å—Ç–≤—É–µ—Ç, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ "–∑–∞–≤–∏—Å–ª–∞", –∞ –Ω–µ "–¥—É–º–∞–µ—Ç". –ë–æ–≥–∞—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ `Critique` –∏ `Plan` –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è, –Ω–æ –≤—ã–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è (–∏–ª–∏ —Å—É–º–º–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ).
- **[üìâ LAZY IMPL] Regex –ü–∞—Ä—Å–∏–Ω–≥**: `VerifierNode` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `re.search(r"Score:\s*([0-9.]+)")`.
  - *–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ*: –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ LLM —É–º–µ—é—Ç –≤—ã–¥–∞–≤–∞—Ç—å JSON. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –Ω–µ–Ω–∞–¥–µ–∂–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Score: **0.9**" –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è, –µ—Å–ª–∏ –º–æ–¥–µ–ª—å –¥–æ–±–∞–≤–∏—Ç –º–∞—Ä–∫–¥–∞—É–Ω). –î–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ 0.5 –±–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏ ‚Äî —ç—Ç–æ –ª–µ–Ω–∏–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ.

## 3. –ì—Ä–∞–Ω–∏—Ü—ã –∏ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **[üß© STATE BUG] –ó–∞—Å—Ç—Ä–µ–≤–∞–Ω–∏–µ –≤ "Deciding"**: `VerifierNode` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å `status: "deciding"`. –ï—Å–ª–∏ –ª–æ–≥–∏–∫–∞ –≤ `graph.py` –¥–∞—Å—Ç —Å–±–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≥—Ä–∞–Ω–∏—á–Ω—ã–π —Å–ª—É—á–∞–π –≤ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏), –≥—Ä–∞—Ñ –º–æ–∂–µ—Ç –∑–∞—Å—Ç—Ä—è—Ç—å –∏–ª–∏ —É–ø–∞—Å—Ç—å.
- **[üîç DATA GAP] –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞**: `CognitiveState` –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç –≥–ª—É–±–æ–∫–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –∏–∑ `user_profile`, —Ç–æ–ª—å–∫–æ –æ–±—â–∏–π `conversation_id`. –ó–Ω–∞–µ—Ç –ª–∏ `Planner`, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç Python –≤–º–µ—Å—Ç–æ JS? –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç—Ç–æ –µ—Å—Ç—å –≤ `state["input"]`.

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –í—ã—Å–æ–∫–∏–π –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç

1. **–†–∞—Å–∫—Ä—ã—Ç—å –º–æ–Ω–æ–ª–æ–≥**: –û–±–Ω–æ–≤–∏—Ç—å `api.py` –∏ `graph.py`, —á—Ç–æ–±—ã —Å—Ç—Ä–∏–º–∏—Ç—å —Å–æ–±—ã—Ç–∏—è `step` (–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –ß–µ—Ä–Ω–æ–≤–∏–∫, –ö—Ä–∏—Ç–∏–∫–∞) –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —á–µ—Ä–µ–∑ SSE.
2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ü–∏–∫–ª**: –ü–æ–∑–≤–æ–ª–∏—Ç—å `Verifier` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å `Re-Plan` (–≤–æ–∑–≤—Ä–∞—Ç –∫ Planner), –µ—Å–ª–∏ –æ—Ü–µ–Ω–∫–∞ —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∞—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, < 0.3), –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ.

### –°—Ä–µ–¥–Ω–∏–π –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç

1. **JSON Mode**: –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ `VerifierNode` –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥ (JSON) –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏.
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**: –ü–∞–¥–∞—Ç—å —Å –æ—à–∏–±–∫–æ–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ (Fail hard), –µ—Å–ª–∏ `langgraph` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –≤–º–µ—Å—Ç–æ —Ä–∞–Ω—Ç–∞–π–º-–∑–∞–≥–ª—É—à–µ–∫.
